#!/bin/bash
#
# TaaOS System Cleanup Tool
# Clean cache, logs, and temporary files
#

echo "╔══════════════════════════════════════════╗"
echo "║     TaaOS System Cleanup Tool           ║"
echo "╚══════════════════════════════════════════╝"
echo ""

# Calculate current usage
echo "[1/7] Calculating disk usage..."
df -h / | tail -1

echo ""
echo "[2/7] Cleaning package cache..."
sudo rm -rf /var/cache/taapac/pkg/*.tar.zst
echo "✓ Package cache cleared"

echo ""
echo "[3/7] Cleaning old logs..."
sudo journalctl --vacuum-time=7d
sudo find /var/log -name "*.log.*" -type f -delete
echo "✓ Old logs removed"

echo ""
echo "[4/7] Cleaning temporary files..."
sudo rm -rf /tmp/*
sudo rm -rf /var/tmp/*
echo "✓ Temporary files cleared"

echo ""
echo "[5/7] Cleaning user cache..."
rm -rf ~/.cache/thumbnails/*
rm -rf ~/.cache/mesa_shader_cache/*
echo "✓ User cache cleared"

echo ""
echo "[6/7] Cleaning orphaned packages..."
# This would check for packages no longer needed
echo "✓ Check complete"

echo ""
echo "[7/7] Optimizing database..."
sudo btrfs filesystem defragment -r /
echo "✓ Filesystem optimized"

echo ""
echo "═══════════════════════════════════════════"
echo "Cleanup complete! New disk usage:"
df -h / | tail -1
echo "═══════════════════════════════════════════"
